# socket
![](/assets/740688-20150907234728090-211300057.jpg)
# Tcp
## client
 //客户端
 //1、创建客户端Socket，指定服务器地址和端口
 Socket socket =newSocket("localhost",10086);
 //2、获取输出流，向服务器端发送信息
 OutputStream os = socket.getOutputStream();//字节输出流
 PrintWriter pw =newPrintWriter(os);//将输出流包装成打印流
 pw.write("用户名：admin；密码：123");
 pw.flush();
 socket.shutdownOutput();
 //3、获取输入流，并读取服务器端的响应信息
 InputStream is = socket.getInputStream();
 BufferedReader br = new BufferedReader(new InputStreamReader(is));
 String info = null;
 while((info=br.readLine())!null){
  System.out.println("我是客户端，服务器说："+info);
 }
 
 //4、关闭资源
 br.close();
 is.close();
 pw.close();
 os.close();
 socket.close();
## server



```
  /**
   * 基于TCP协议的Socket通信，实现用户登录，服务端
  */
  //1、创建一个服务器端Socket，即ServerSocket，指定绑定的端口，并监听此端口
  ServerSocket serverSocket =newServerSocket(10086);//1024-65535的某个端口
  //2、调用accept()方法开始监听，等待客户端的连接
  Socket socket = serverSocket.accept();
  //3、获取输入流，并读取客户端信息
  InputStream is = socket.getInputStream();
 InputStreamReader isr =newInputStreamReader(is);
 BufferedReader br =newBufferedReader(isr);
 String info =null;
 while((info=br.readLine())!=null){
 System.out.println("我是服务器，客户端说："+info)；
 }
 socket.shutdownInput();//关闭输入流
 //4、获取输出流，响应客户端的请求
 OutputStream os = socket.getOutputStream();
 PrintWriter pw = new PrintWriter(os);
 pw.write("欢迎您！");
 pw.flush();
 
 
 //5、关闭资源
 pw.close();
 os.close();
 br.close();
 isr.close();
 is.close();
 socket.close();
 serverSocket.close();
```


# UDP
## server

```
 //服务器端，实现基于UDP的用户登录
 //1、创建服务器端DatagramSocket，指定端口
 DatagramSocket socket =new datagramSocket(10010);
 //2、创建数据报，用于接受客户端发送的数据
 byte[] data =newbyte[1024];//
 DatagramPacket packet =newDatagramPacket(data,data.length);
 //3、接受客户端发送的数据
 socket.receive(packet);//此方法在接受数据报之前会一致阻塞
 //4、读取数据
 String info =newString(data,o,data.length);
 System.out.println("我是服务器，客户端告诉我"+info);
 
 
 //=========================================================
 //向客户端响应数据
 //1、定义客户端的地址、端口号、数据
 InetAddress address = packet.getAddress();
 int port = packet.getPort();
 byte[] data2 = "欢迎您！".geyBytes();
 //2、创建数据报，包含响应的数据信息
 DatagramPacket packet2 = new DatagramPacket(data2,data2.length,address,port);
 //3、响应客户端
 socket.send(packet2);
 //4、关闭资源
 socket.close();
```
##client
 //客户端
//1、定义服务器的地址、端口号、数据
 InetAddress address =InetAddress.getByName("localhost");
 int port =10010;
 byte[] data ="用户名：admin;密码：123".getBytes();
 //2、创建数据报，包含发送的数据信息
 DatagramPacket packet = newDatagramPacket(data,data,length,address,port);
 //3、创建DatagramSocket对象
 DatagramSocket socket =newDatagramSocket();
 //4、向服务器发送数据
 socket.send(packet);
 
 
 //接受服务器端响应数据
 //======================================
 //1、创建数据报，用于接受服务器端响应数据
 byte[] data2 = new byte[1024];
 DatagramPacket packet2 = new DatagramPacket(data2,data2.length);
 //2、接受服务器响应的数据
 socket.receive(packet2);
 String raply = new String(data2,0,packet2.getLenth());
 System.out.println("我是客户端，服务器说："+reply);
 //4、关闭资源
 socket.close();

# 网络协议
## Http
### 媒体类型
因特网上有数千种不同的数据类型，HTTP 仔细地给每种要通过 Web 传输的对象都打上了名为 MIME 类型 （MIME type）的数据格式标签。最初设计 MIME 类型是一种文本标记，表示一种主要的对象类型和一个特定的子类型，中间由一条斜杠来分隔。

* 普通的 ASCII 文本文档由 text/plain 类型来标记。
* JPEG 格式的图片为 image/jpeg 类型。 
* GIF 格式的图片为 image/gif 类型。 
* Apple 的 QuickTime 电影为 video/quicktime 类型。
*  微软的 PowerPoint 演示文件为 application/vnd.ms-powerpoint 类型。
### URI 统一资源标识符
分为
*  URL 统一资源定位符（URL）是资源标识符最常见的形式
大部分 URL 都遵循一种标准格式，这种格式包含三个部分。
 *  URL 的第一部分被称为 方案 （scheme），说明了访问资源所使用的协议类型。这部分通常就是 HTTP 协议（http://）。
 *  第二部分给出了服务器的因特网地址（比如，www.joes-hardware.com ）。 
 * 其余部分指定了 Web 服务器上的某个资源（比如，/specials/saw-blade.gif）。 现在，几乎所有的 URI 都是 URL。


* URN 的第二种形式就是统一资源名（URN）。
URN的第二种形式就是统一资源名（URN）。URN 是作为特定内容的唯一名称使用的，与目前的资源所在地无关。使用这些与位置无关的,**但是现在还没有使用**

* 所以现在的URI和URL在某种程度上是等价的。

###　Web页面中可以包含多个对象
应用程序完成一项任务时通常会发布多个 HTTP 事务。比如，Web 浏览器会发布一系列 HTTP 事务来获取并显示一个包含了丰富图片的 Web 页面。浏览器会执行一个事务来获取描述页面布局的 HTML“框架”，然后发布另外的 HTTP 事务来获取每个嵌入式图片、图像面板、Java 小程序等。这些嵌入式资源甚至可能位于不同的服务器上，如图 1-6 所示。因此，一个“Web 页面”通常并不是单个资源，而是一组资源的集合。

##http 报文
![](/assets/2017-02-17 15 24 19.png)

* **起始行** 报文的第一行就是起始行，在请求报文中用来说明要做些什么，在响应报文中说明出现了什么情况。 
* **首部字段** 起始行后面有零个或多个首部字段。每个首部字段都包含一个名字和一个值，为了便于解析，两者之间用冒号（:）来分隔。首部以一个空行结束。添加一个首部字段和添加新行一样简单。 
* **主体** 空行之后就是可选的报文主体了，其中包含了所有类型的数据。请求主体中包括了要发送给 Web 服务器的数据；响应主体中装载了要返回给客户端的数据。起始行和首部都是文本形式且都是结构化的，而主体则不同，主体中可以包含任意的二进制数据（比如图片、视频、音轨、软件程序）。当然，主体中也可以包含文本。

![](/assets/2017-02-17 15 26 02.png)
## TCP IP协议
![](/assets/2017-02-17 15 30 24.png)

![](/assets/2017-02-17 15 32 22.png)

步骤如下： 
(a) 浏览器从 URL 中解析出服务器的主机名；
(b) 浏览器将服务器的主机名转换成服务器的 IP 地址；
(c) 浏览器将端口号（如果有的话）从 URL 中解析出来；
(d) 浏览器建立一条与 Web 服务器的 TCP 连接； 
(e) 浏览器向服务器发送一条 HTTP 请求报文；
(f) 服务器向浏览器回送一条 HTTP 响应报文；
(g) 关闭连接，浏览器显示文档。

## URI和资源
比如说，你想要获取 URL http://www.joes-hardware.com/seasonal/index-fall.html 。那么 URL 分以下三部分。
* URL 的第一部分（http）是 URL 方案 （scheme）。方案可以告知 Web 客户端 怎样 访问资源。在这个例子中，URL 说明要使用 HTTP 协议。
* URL 的第二部分（www.joes-hardware.com）指的是服务器的位置。这部分告知 Web 客户端资源 位于何处 。
* URL 的第三部分（/seasonal/index-fall.html）是资源路径。路径说明了请求的是服务器上

URL可以通过HTTP之外的其他协议来访问资源。它们可以指向因特网上的任意资源
![](/assets/2017-02-17 16 14 12.png)
**三个例子： **
个人的email账户： mailto:president@whitehouse.gov 
通过其他协议（比如FTP协议）访问的各种文件： ftp://ftp.lots-o-books.com/pub/complete-price-list.xls 
从流视频服务器上下载电影： rtsp://www.joes-hardware.com:554/interview/cto_video


这个是URI的规则
```
<scheme>://<user>:<password>@<host>:<port>/<path>;<params>?<query>#<frag>
```
中包含了所有这些组件。URL 最重要的 3 个部分是 方案 （scheme）、 主机 （host）和 路径 （path）。表

 组　　件   描　　述   默　认　值   方案   访问服务器以获取资源时要使用哪种协议   无   用户   某些方案访问资源时需要的用户名   匿名   密码   用户名后面可能要包含的密码，中间由冒号（:）分隔   <E-mail地址>   主机   资源宿主服务器的主机名或点分IP地址   无   端口   资源宿主服务器正在监听的端口号。很多方案都有默认端口号（HTTP的默认端口号为80）   每个方案特有   路径   服务器上资源的本地名，由一个斜杠（/）将其与前面的URL组件分隔开来。路径组件的语法是与服务器和方案有关的（本章稍后会讲到URL路径可以分为若干个段，每段都可以有其特有的组件。）   无   参数   某些方案会用这个组件来指定输入参数。参数为名/值对。URL中可以包含多个参数字段，它们相互之间以及与路径的其余部分之间用分号（;）分隔   无   查询   某些方案会用这个组件传递参数以激活应用程序（比如数据库、公告板、搜索引擎以及其他因特网网关）。查询组件的内容没有通用格式。用字符“?”将其与URL的其余部分分隔开来   无   片段   一小片或一部分资源的名字。引用对象时，不会将frag字段传送给服务器；这个字段是在客户端内部使用的。通过字符“#”将其与URL的其余部分分隔开来 

[美]David Gourley Brian Totty Marjorie Sayer Sailu Reddy Aushu Aggarwal. HTTP权威指南 (图灵程序设计丛书) (Kindle 位置 663-686). 人民邮电出版社. Kindle 版本. 


